<div class="container my-3">

  <!-- Add / Edit Form -->
  <div *ngIf="isemployeeForm" class="card shadow p-3">
    <h4 class="mb-3">{{ isEdit ? 'Edit Employee' : 'Add Employee' }}</h4>

    <form [formGroup]="employeeForm" (ngSubmit)="submit()" novalidate>
      <div class="row g-3">
        
        <div class="col-md-6">
          <label class="form-label">Name *</label>
          <input class="form-control" formControlName="name" />
          <div class="text-danger" *ngIf="employeeForm.controls['name'].touched && employeeForm.controls['name'].invalid">
            Name is required (min 3 chars)
          </div>
        </div>

        <div class="col-md-6">
          <label class="form-label">Role *</label>
          <input class="form-control" formControlName="role" />
          <div class="text-danger" *ngIf="employeeForm.controls['role'].touched && employeeForm.controls['role'].invalid">
            Role is required
          </div>
        </div>

        <div class="col-md-6">
          <label class="form-label">Mobile 1 *</label>
          <input class="form-control" formControlName="mobile1" />
          <div class="text-danger" *ngIf="employeeForm.controls['mobile1'].touched && employeeForm.controls['mobile1'].invalid">
            Enter valid 10 digit number
          </div>
        </div>

        <div class="col-md-6">
          <label class="form-label">Mobile 2</label>
          <input class="form-control" formControlName="mobile2" />
        </div>

        <div class="col-md-6">
          <label class="form-label">Salary *</label>
          <input type="number" class="form-control" formControlName="monthlySalary" />
          <div class="text-danger" *ngIf="employeeForm.controls['monthlySalary'].touched && employeeForm.controls['monthlySalary'].invalid">
            Salary must be at least 1000
          </div>
        </div>

        <div class="col-md-6">
          <label class="form-label">Aadhaar</label>
          <input class="form-control" formControlName="aadhaar" />
          <div class="text-danger" *ngIf="employeeForm.controls['aadhaar'].touched && employeeForm.controls['aadhaar'].invalid">
            Aadhaar must be 12 digits
          </div>
        </div>

        <div class="col-md-6">
          <label class="form-label">PAN Card</label>
          <input class="form-control" formControlName="panCard" />
          <div class="text-danger" *ngIf="employeeForm.controls['panCard'].touched && employeeForm.controls['panCard'].invalid">
            Invalid PAN format
          </div>
        </div>

        <div class="col-12">
          <label class="form-label">Address</label>
          <textarea class="form-control" formControlName="address"></textarea>
        </div>

      </div>

      <div class="mt-3">
        <button type="submit" class="btn btn-success me-2">{{ isEdit ? 'Update' : 'Add' }}</button>
        <button type="button" class="btn btn-secondary" (click)="resetForm()">Cancel</button>
      </div>
    </form>
  </div>

  <!-- Success & Error Messages -->
  <!-- <div *ngIf="message" class="alert alert-success mt-2">{{ message }}</div>
  <div *ngIf="error" class="alert alert-danger mt-2">{{ error }}</div> -->

  <!-- Employee Table -->
  <div *ngIf="!isemployeeForm" class="card shadow p-3 mt-3">
    <div class="d-flex justify-content-between align-items-center">
      <h4>Employee List</h4>
      <button class="btn btn-primary" (click)="addNew()">Add New</button>
    </div>

    <div *ngIf="loading" class="text-info my-2">Loading...</div>

    <div class="table-responsive mt-3" *ngIf="employees.length">
      <table class="table table-bordered table-hover align-middle text-center">
        <thead class="table-light">
          <tr>
            <th>#</th>
            <th>Name</th>
            <th>Mobile</th>
            <th>Salary</th>
            <th>Wallet</th>
            <th>Aadhaar</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let emp of employees; let i = index">
            <td>{{ i + 1 }}</td>
            <td>{{ emp.name }}</td>
            <td>{{ emp.mobile1 }}</td>
            <td>{{ emp.monthlySalary | number:'1.0-0' }}</td>
            <td>{{ walletBalance(emp.employeeId) | number:'1.0-0' }}</td>
            <td>{{ emp.aadhaar }}</td>
            <td>
              <button class="btn btn-sm btn-warning me-1" (click)="edit(emp)">Edit</button>
              <button class="btn btn-sm btn-danger" (click)="delete(emp.employeeId)">Delete</button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <div *ngIf="!loading && !employees.length" class="text-muted">No employees found.</div>
  </div>
</div>
