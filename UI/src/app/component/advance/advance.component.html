<div class="container">
  <h2 class="title">Employee Advances</h2>
<div *ngIf="!sendAdvanceForm">
  <!-- ✅ Alerts -->
  <div *ngIf="successMessage" class="alert alert-success">{{ successMessage }}</div>
  <div *ngIf="errorMessage" class="alert alert-danger">{{ errorMessage }}</div>

  <!-- ✅ Filter -->
  <div class="mb-3">
    <input
      type="text"
      class="form-control"
      placeholder="Search by employee name..."
      [(ngModel)]="searchText"
      (input)="filterEmployees()"
    /> 
  </div>

  <!-- ✅ Employee Table -->
  <div class="table-responsive">
    <table class="table table-bordered table-hover shadow-sm">
      <thead class="table-dark">
        <tr>
          <th>Name</th>
          <th>Mobile</th>
          <th>Advance Balance</th>
          <th>Action</th>
        </tr>
      </thead>
      <tbody>

    
        <tr *ngFor="let emp of filteredEmployees">
          <td>{{ emp.name }}</td>
          <td>{{ emp.mobile1 }}</td>
          <td>{{ emp.advanceBalance | currency }}</td>
          <td class="d-flex">
            <button class="btn btn-sm btn-primary me-1" (click)="viewEmployee(emp)">
                <i class="bi bi-eye"></i>
              </button>
            <button class="btn btn-sm btn-primary" (click)="selectEmployee(emp)">
              Select
            </button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>
  <!-- ✅ Advance Form -->
  <div class="card shadow p-3 mt-4 position-relative" *ngIf="sendAdvanceForm">
  <!-- Close button -->
  <button 
    type="button" 
    class="btn-close position-absolute top-0 end-0 m-2" 
    aria-label="Close" 
    (click)="closeForm()">
  </button>

  <h4>Send Advance</h4>
  <form [formGroup]="advanceForm" (ngSubmit)="onSubmit()">
    <div class="mb-3">
      <label>Employee ID</label>
      <input type="number" class="form-control" formControlName="employeeId" readonly />
    </div>

    <div class="mb-3">
      <label>Reason</label>
      <input type="text" class="form-control" formControlName="reason" />
    </div>

    <div class="mb-3">
      <label>Payment Mode</label>
      <select class="form-select" formControlName="paymentMode">
        <option value="Cash">Cash</option>
        <option value="Bank Transfer">Bank Transfer</option>
        <option value="UPI">UPI</option>
      </select>
    </div>

    <div class="mb-3">
      <label>Amount</label>
      <input type="number" class="form-control" formControlName="amount" />
    </div>

    <div class="mb-3">
      <label>Date</label>
      <input type="date" class="form-control" formControlName="date" />
    </div>

    <div class="mb-3">
      <label>Payment Category</label>
      <select class="form-select" formControlName="payment_catagaory">
        <option value="d">Send To Employee</option>
        <option value="credit">Get From Employee</option>
      </select>
    </div>

    <button class="btn btn-success w-100" [disabled]="advanceForm.invalid">
      Send Advance
    </button>
  </form>
</div>

</div>
