<div class="p-4 max-w-7xl mx-auto">
  <h2 class="text-2xl font-semibold mb-4 text-center text-blue-600">ðŸ’° Employee Salary Preview</h2>

  <div *ngIf="loading" class="text-center py-8 text-gray-500">Loading...</div>

  <table class="w-full border border-gray-200 rounded-lg shadow-sm" *ngIf="!loading && salaryList.length">
    <thead class="bg-blue-500 text-white">
      <tr>
        <th class="p-2">Employee</th>
        <th class="p-2">Start Date</th>
        <th class="p-2">End Date</th>
        <th class="p-2">Present</th>
        <th class="p-2">Absent</th>
        <th class="p-2">Half</th>
        <th class="p-2">OT</th>
        <th class="p-2">Total</th>
        <th class="p-2">Action</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let s of salaryList" class="border-b hover:bg-blue-50 transition">
        <td class="p-2 font-semibold text-gray-700">{{ s.employeeName }}</td>
        <td class="p-2">{{ s.startDate | date:'dd-MMM-yyyy' }}</td>
        <td class="p-2">{{ s.endDate | date:'dd-MMM-yyyy' }}</td>
        <td class="p-2 text-green-600 font-semibold">{{ s.presentDays }}</td>
        <td class="p-2 text-red-600 font-semibold">{{ s.absentDays }}</td>
        <td class="p-2 text-yellow-600 font-semibold">{{ s.halfDays }}</td>
        <td class="p-2">{{ s.otHours }}</td>
        <td class="p-2 text-blue-600 font-bold">â‚¹{{ s.totalSalaryPreview | number:'1.0-2' }}</td>
        <td class="p-2 flex flex-wrap gap-2 justify-center">
          <button class="bg-blue-500 text-white px-3 py-1 rounded-md hover:bg-blue-600"
                  (click)="viewSalaryHistory(s)">View</button>

          <button class="bg-green-500 text-white px-3 py-1 rounded-md hover:bg-green-600"
                  (click)="openGenerateModal(s)">Generate</button>
        </td>
      </tr>
    </tbody>
  </table>

  <p *ngIf="!loading && !salaryList.length" class="text-center text-gray-500 py-6">
    No salary data available.
  </p>
</div>

<!-- ðŸ§¾ Salary History Modal -->
<dialog id="historyModal" class="modal">
  <div class="modal-box w-11/12 max-w-3xl bg-white rounded-lg p-6">
    <h3 class="text-xl font-semibold mb-4 text-blue-600">
      {{ selectedEmployee?.employeeName }} - Salary History
    </h3>

    <table class="w-full border border-gray-300">
      <thead class="bg-gray-200">
        <tr>
          <th class="p-2">Period</th>
          <th class="p-2">Present</th>
          <th class="p-2">Absent</th>
          <th class="p-2">Half</th>
          <th class="p-2">OT</th>
          <th class="p-2">Final Salary</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let h of salaryHistory" class="border-b hover:bg-gray-100">
          <td class="p-2">{{ h.startDate | date:'dd-MMM' }} - {{ h.endDate | date:'dd-MMM-yyyy' }}</td>
          <td class="p-2">{{ h.presentDays }}</td>
          <td class="p-2">{{ h.absentDays }}</td>
          <td class="p-2">{{ h.halfDays }}</td>
          <td class="p-2">{{ h.totalOTHours }}</td>
          <td class="p-2 font-bold text-blue-600">â‚¹{{ h.finalSalary | number:'1.0-2' }}</td>
        </tr>
      </tbody>
    </table>

    <div class="text-right mt-4">
      <button class="bg-red-500 text-white px-4 py-1 rounded-md"
              (click)="closeHistoryModal()">Close</button>
    </div>
  </div>
</dialog>

<!-- ðŸ†• Generate Salary Modal -->
<dialog id="generateModal" class="modal">
  <div class="modal-box w-96 bg-white rounded-lg p-6">
    <h3 class="text-lg font-semibold text-center text-green-600 mb-3">Generate Salary</h3>

    <form [formGroup]="salaryForm" (ngSubmit)="generateSalary()">
      <label class="block mb-2 font-semibold">Start Date</label>
      <input type="date" formControlName="startDate" class="input-box mb-3" />

      <label class="block mb-2 font-semibold">End Date</label>
      <input type="date" formControlName="endDate" class="input-box mb-3" />

      <div class="flex justify-between mt-4">
        <button type="button" class="bg-gray-400 text-white px-4 py-1 rounded-md"
                (click)="closeGenerateModal()">Cancel</button>
        <button type="submit" class="bg-green-500 text-white px-4 py-1 rounded-md hover:bg-green-600">Generate</button>
      </div>
    </form>
  </div>
</dialog>
