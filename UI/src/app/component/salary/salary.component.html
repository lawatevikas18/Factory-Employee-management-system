<div class="salary-container">
  <h2 class="heading">ðŸ’° Employee Salary Preview</h2>

  <div *ngIf="loading" class="loading">
    <i class="fa fa-spinner fa-spin"></i> Loading...
  </div>

  <div *ngIf="!loading && salaryList.length; else noData">
    <!-- Desktop table -->
    <div class="table-wrapper desktop-view">
      <table>
        <thead>
          <tr>
            <th>Employee</th>
            <th>Start</th>
            <th>End</th>
            <th>P</th>
            <th>A</th>
            <th>H</th>
            <th>OT</th>
            <th>Total</th>
            <th>Action</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let s of salaryList">
            <td>{{ s.employeeName }}</td>
            <td>{{ s.startDate | date:'dd-MMM' }}</td>
            <td>{{ s.endDate | date:'dd-MMM' }}</td>
            <td class="present">{{ s.presentDays }}</td>
            <td class="absent">{{ s.absentDays }}</td>
            <td class="half">{{ s.halfDays }}</td>
            <td>{{ s.otHours }}</td>
            <td class="total">â‚¹{{ s.totalSalaryPreview | number:'1.0-2' }}</td>
            <td>
              <button class="btn-view" (click)="viewSalaryHistory(s)">View</button>
              <button class="btn-generate" (click)="openGenerateModal(s)">Generate</button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <!-- Mobile card layout -->
    <div class="mobile-view">
      <div class="salary-card" *ngFor="let s of salaryList">
        <h4>{{ s.employeeName }}</h4>
        <p><strong>Period:</strong> {{ s.startDate | date:'dd-MMM' }} - {{ s.endDate | date:'dd-MMM' }}</p>
        <p><strong>P:</strong> {{ s.presentDays }} | <strong>A:</strong> {{ s.absentDays }} | <strong>H:</strong> {{ s.halfDays }}</p>
        <p><strong>OT:</strong> {{ s.otHours }} hrs</p>
        <p class="total"><strong>Total:</strong> â‚¹{{ s.totalSalaryPreview | number:'1.0-2' }}</p>
        <div class="actions">
          <button class="btn-view" (click)="viewSalaryHistory(s)">View</button>
          <button class="btn-generate" (click)="openGenerateModal(s)">Generate</button>
        </div>
      </div>
    </div>
  </div>

  <ng-template #noData>
    <p class="no-data">No salary data available.</p>
  </ng-template>

  <!-- History Modal -->
  <div class="modal-backdrop" *ngIf="showHistoryModal">
    <div class="modal-content">
      <h3>{{ selectedEmployee?.employeeName }} - Salary History</h3>
      <div class="table-wrapper">
        <table>
          <thead>
            <tr>
              <th>Period</th>
              <th>P</th>
              <th>A</th>
              <th>H</th>
              <th>OT</th>
              <th>Salary</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let h of salaryHistory">
              <td>{{ h.startDate | date:'dd-MMM' }} - {{ h.endDate | date:'dd-MMM-yyyy' }}</td>
              <td>{{ h.presentDays }}</td>
              <td>{{ h.absentDays }}</td>
              <td>{{ h.halfDays }}</td>
              <td>{{ h.totalOTHours }}</td>
              <td class="total">â‚¹{{ h.finalSalary | number:'1.0-2' }}</td>
            </tr>
          </tbody>
        </table>
      </div>

      <div class="actions">
        <button class="btn-close" (click)="closeModals()">Close</button>
      </div>
    </div>
  </div>

  <!-- Generate Salary Modal -->
  <div class="modal-backdrop" *ngIf="showGenerateModal">
    <div class="modal-content small">
      <h3>Generate Salary</h3>
      <form [formGroup]="salaryForm" (ngSubmit)="generateSalary()">
        <label>Start Date</label>
        <input type="date" formControlName="startDate" />

        <label>End Date</label>
        <input type="date" formControlName="endDate" />

        <div class="actions">
          <button type="button" class="btn-close" (click)="closeModals()">Cancel</button>
          <button type="submit" class="btn-generate">Generate</button>
        </div>
      </form>
    </div>
  </div>
</div>
